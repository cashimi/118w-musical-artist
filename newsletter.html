<!-- Javier -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Newsletter</title>
    <link rel="stylesheet" href="assets/styles.css">
</head>

<body>

<header>
    <div class="container">
        <div class="brand">
            <div class="logo">MT</div>
            <div>malcolmtodd.life</div>
        </div>

        <nav class="nav-links">
            <a href="index.html">Home</a>
            <a href="about.html">About</a>
            <a href="discography.html">Discography</a>
            <a href="shop.html">Shop</a>
            <a href="newsletter.html" class="active">Newsletter</a>
        </nav>
    </div>
</header>

<main class="container">
    <section class="section">
        <h2>Join the Newsletter</h2>

        <!-- FormSubmit form -->
        <form
          id="newsletter-form"
          class="grid-2"
          action="https://formsubmit.co/ajax/javier.contreras@sjsu.edu"
          method="POST"
        >

            <!-- Email input -->
            <input
              type="email"
              id="email"
              name="email"
              placeholder="Enter email"
              required
            />

            <button class="btn" type="submit">Subscribe</button>

            <!-- FormSubmit settings -->
            <input type="hidden" name="_subject" value="New newsletter subscriber!" />
            <input type="hidden" name="_template" value="table" />

            <!-- Auto-response (sent to the user) -->
            <input type="hidden" name="_autoresponse"
                   value="Thank you for subscribing to the newsletter! Stay tuned for updates." />

            <!-- Optional: prevent spam bots -->
            <input type="hidden" name="_captcha" value="false">
        </form>

        <!-- Welcome message on the page -->
        <div id="welcome-message"
             style="margin-top:15px; color:#2a4e7b; font-weight:600;"></div>

        <p style="margin-top:1rem;color:#335155;">
            This is a demo form. Hook up FastAPI + SQLite later.
        </p>
    </section>
</main>

<footer>
    <div class="container footer">
        <span class="badge">Â© 2025 Malcolm Todd (demo)</span>

        <div class="links">
            <a style="color:white;text-decoration:none;" href="#">Instagram</a>
            <a style="color:white;text-decoration:none;" href="#">YouTube</a>
            <a style="color:white;text-decoration:none;" href="#">Spotify</a>
        </div>
    </div>
</footer>

<!-- Your existing JS -->
<script src="assets/main.js"></script>

<!-- Script that sends to FormSubmit and shows welcome message -->
<script>
  const form = document.getElementById("newsletter-form");
  const emailInput = document.getElementById("email");
  const welcomeBox = document.getElementById("welcome-message");

  form.addEventListener("submit", async function (event) {
    event.preventDefault(); // prevent redirect

    const email = emailInput.value.trim();
    if (!email) {
      welcomeBox.textContent = "Please enter a valid email.";
      return;
    }

    // Prepare FormSubmit request
    const url = form.getAttribute("action");
    const data = { email: email };

    try {
      const response = await fetch(url, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Accept": "application/json"
        },
        body: JSON.stringify(data)
      });

      if (response.ok) {
        welcomeBox.textContent =
          "Welcome to the newsletter, " + email + "! ðŸŽ‰ Check your inbox.";
        emailInput.value = "";
      } else {
        welcomeBox.textContent =
          "Something went wrong. Please try again.";
      }
    } catch (err) {
      welcomeBox.textContent =
        "Network error. Please try again in a moment.";
    }
  });
</script>

</body>
</html>

